<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jersey Tax Residency Assessment</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function JerseyTaxResidency() {
            const [step, setStep] = useState('initial');
            const [answers, setAnswers] = useState({});
            const [result, setResult] = useState(null);

            const handleAnswer = (key, value) => {
                const newAnswers = { ...answers, [key]: value };
                setAnswers(newAnswers);

                if (key === 'days' && value === 'under60') {
                    setResult({
                        status: 'Non-Resident (Short-term Business Visitor)',
                        description: 'You are considered a short-term business visitor and non-resident.',
                        taxLiability: 'Your Jersey-sourced income is exempt from income tax. You are not required to register with Revenue Jersey.',
                        type: 'non-resident'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'days' && value === 'over60') {
                    setStep('moving');
                    return;
                }

                if (key === 'moving' && value === 'yes') {
                    setStep('duration');
                    return;
                }

                if (key === 'moving' && value === 'no') {
                    setStep('visitor');
                    return;
                }

                if (key === 'duration' && value === 'indefinite') {
                    setResult({
                        status: 'Resident and Ordinarily Resident',
                        description: 'You are resident and ordinarily resident from day 1 as you are settling permanently in Jersey.',
                        taxLiability: 'Liable to Jersey income tax on your world-wide income regardless of where it arises. If you pay tax on the same income in another jurisdiction, a credit may be available for foreign taxes paid. Tax allowances will be apportioned based on your arrival date if part way through the year.',
                        type: 'resident-ordinarily'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'duration' && value === 'over4years') {
                    setResult({
                        status: 'Resident and Ordinarily Resident',
                        description: 'You are resident and ordinarily resident from day 1 as you foresee living in Jersey for more than four years.',
                        taxLiability: 'Liable to Jersey income tax on your world-wide income regardless of where it arises. If you pay tax on the same income in another jurisdiction, a credit may be available for foreign taxes paid. Tax allowances will be apportioned based on your arrival date if part way through the year.',
                        type: 'resident-ordinarily'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'duration' && value === 'under4years') {
                    setStep('contract');
                    return;
                }

                if (key === 'contract' && value === 'fixed') {
                    setResult({
                        status: 'Resident but Not Ordinarily Resident',
                        description: 'You are resident but not ordinarily resident during the first four years, as you have a fixed-term contract of four years or fewer while maintaining your centre of life elsewhere.',
                        taxLiability: 'You owe income tax only on Jersey-sourced income and income remitted to Jersey. If your contract extends beyond four years, you become resident and ordinarily resident from the start of year 5 or from the date of contract change.',
                        allowances: 'Allowances are apportioned for each day not spent in Jersey (excluding holidays and business trips).',
                        type: 'resident-not-ordinarily'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'contract' && value === 'notfixed') {
                    setResult({
                        status: 'Resident and Ordinarily Resident',
                        description: 'You are resident and ordinarily resident from day 1.',
                        taxLiability: 'Liable to Jersey income tax on your world-wide income regardless of where it arises. If you pay tax on the same income in another jurisdiction, a credit may be available for foreign taxes paid. Tax allowances will be apportioned based on your arrival date if part way through the year.',
                        type: 'resident-ordinarily'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'visitor' && value === 'hotel') {
                    setResult({
                        status: 'Generally Non-Resident',
                        description: 'If you stay in hotels and do not exceed 60 days, you are generally not considered resident.',
                        taxLiability: 'Limited or no Jersey income tax liability on Jersey-sourced income only.',
                        type: 'non-resident'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'visitor' && value === 'owned') {
                    setStep('nights');
                    return;
                }

                if (key === 'nights' && value === 'over90') {
                    setResult({
                        status: 'Resident and Ordinarily Resident (from Year 5)',
                        description: 'You are treated as resident and ordinarily resident from year 5 as you average more than 90 nights per year over a 4-year period in available accommodation.',
                        taxLiability: 'From year 5 onwards, liable to Jersey income tax on your world-wide income. Before year 5, you are resident but not ordinarily resident, liable on income arising in and remitted to Jersey.',
                        type: 'resident-ordinarily'
                    });
                    setStep('result');
                    return;
                }

                if (key === 'nights' && value === 'under90') {
                    setResult({
                        status: 'Resident but Not Ordinarily Resident',
                        description: 'You are resident but not ordinarily resident as you stay in available accommodation but do not average more than 90 nights per year.',
                        taxLiability: 'Liable to Jersey income tax on all income arising in, and remitted to, Jersey.',
                        allowances: 'Allowances are apportioned for each day not spent in Jersey (excluding holidays and business trips).',
                        type: 'resident-not-ordinarily'
                    });
                    setStep('result');
                    return;
                }
            };

            const resetQuestionnaire = () => {
                setStep('initial');
                setAnswers({});
                setResult(null);
            };

            const renderStep = () => {
                if (step === 'result') {
                    return (
                        <div className="space-y-6">
                            <div className={`${result.type === 'non-resident' ? 'bg-green-50 border-green-200' : result.type === 'resident-not-ordinarily' ? 'bg-yellow-50 border-yellow-200' : 'bg-red-50 border-red-200'} border p-6 rounded`}>
                                <div className="flex items-start">
                                    <svg className="h-7 w-7 text-blue-600 mr-3 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <circle cx="12" cy="12" r="10" strokeWidth="2"/>
                                        <path strokeWidth="2" d="M12 16v-4M12 8h.01"/>
                                    </svg>
                                    <div className="flex-1">
                                        <h3 className="text-lg font-bold text-gray-900 mb-3">Your Tax Residency Status</h3>
                                        <div className="bg-white p-4 rounded border border-gray-200 mb-4">
                                            <p className="text-xl font-bold text-red-600">{result.status}</p>
                                        </div>
                                        <p className="text-gray-800 mb-4 leading-relaxed">{result.description}</p>
                                        <div className="bg-gray-50 p-4 rounded border border-gray-200">
                                            <h4 className="font-bold text-gray-900 mb-2">Tax Liability:</h4>
                                            <p className="text-gray-800 leading-relaxed">{result.taxLiability}</p>
                                            {result.allowances && (
                                                <>
                                                    <h4 className="font-bold text-gray-900 mt-4 mb-2">Allowances:</h4>
                                                    <p className="text-gray-800 leading-relaxed">{result.allowances}</p>
                                                </>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button
                                onClick={resetQuestionnaire}
                                className="w-full bg-red-600 text-white py-3 px-6 rounded font-semibold hover:bg-red-700 transition-colors flex items-center justify-center"
                            >
                                <svg className="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path strokeWidth="2" d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                                    <path strokeWidth="2" d="M21 3v5h-5"/>
                                    <path strokeWidth="2" d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                                    <path strokeWidth="2" d="M8 16H3v5"/>
                                </svg>
                                Start New Assessment
                            </button>
                        </div>
                    );
                }

                const questions = {
                    initial: {
                        title: 'How many days will you spend in Jersey per year?',
                        subtitle: 'This includes all visits throughout the year, including days of arrival and departure.',
                        options: [
                            { value: 'under60', title: 'Fewer than 60 days', subtitle: 'Short-term business visitor' },
                            { value: 'over60', title: '60 days or more', subtitle: 'Continue to determine your status' }
                        ]
                    },
                    moving: {
                        title: 'Are you moving to Jersey to live and work?',
                        subtitle: 'This means relocating your main home, possessions, and financial affairs to Jersey.',
                        options: [
                            { value: 'yes', title: 'Yes - Moving to Jersey', subtitle: 'Relocating my life to the Island' },
                            { value: 'no', title: 'No - Living abroad but visiting', subtitle: 'Maintaining my main home elsewhere' }
                        ]
                    },
                    duration: {
                        title: 'How long do you plan to live in Jersey?',
                        subtitle: 'Consider your employment duration and whether you\'re settling permanently.',
                        options: [
                            { value: 'indefinite', title: 'Settling permanently (indefinite)', subtitle: 'Making Jersey my main home with no end date' },
                            { value: 'over4years', title: 'More than 4 years', subtitle: 'I foresee living here for over 4 years' },
                            { value: 'under4years', title: '4 years or fewer', subtitle: 'Temporary stay while maintaining life elsewhere' }
                        ]
                    },
                    contract: {
                        title: 'Is your employment contract fixed-term for 4 years or fewer?',
                        subtitle: 'This applies if you\'re maintaining your centre of life in a different country.',
                        options: [
                            { value: 'fixed', title: 'Yes - Fixed term ≤ 4 years', subtitle: 'Defined contract end date within 4 years' },
                            { value: 'notfixed', title: 'No - Open-ended or unclear', subtitle: 'Not a fixed-term contract of 4 years or fewer' }
                        ]
                    },
                    visitor: {
                        title: 'Where do you stay when visiting Jersey?',
                        subtitle: 'Available accommodation means property you own, rent, or lease - not hotels.',
                        options: [
                            { value: 'hotel', title: 'Hotels or guest houses only', subtitle: 'No property I own or lease' },
                            { value: 'owned', title: 'Property I own, rent, or lease', subtitle: 'Available accommodation in my name' }
                        ]
                    },
                    nights: {
                        title: 'How many nights per year do you spend in Jersey (on average)?',
                        subtitle: 'Consider your average over a 4-year period.',
                        options: [
                            { value: 'over90', title: 'More than 90 nights per year', subtitle: 'Averaged over 4 years' },
                            { value: 'under90', title: '90 nights or fewer per year', subtitle: 'Averaged over 4 years' }
                        ]
                    }
                };

                const currentQuestion = questions[step];

                return (
                    <div className="space-y-6">
                        <div className="bg-gray-50 p-5 rounded border border-gray-200">
                            <h3 className="text-lg font-bold text-gray-900 mb-3">{currentQuestion.title}</h3>
                            <p className="text-sm text-gray-700 leading-relaxed">{currentQuestion.subtitle}</p>
                        </div>
                        
                        <div className="space-y-3">
                            {currentQuestion.options.map(option => (
                                <button
                                    key={option.value}
                                    onClick={() => handleAnswer(step, option.value)}
                                    className="w-full bg-white border-2 border-gray-300 hover:border-red-600 hover:bg-red-50 py-4 px-6 rounded text-left transition-colors"
                                >
                                    <div className="font-bold text-gray-900">{option.title}</div>
                                    <div className="text-sm text-gray-600 mt-1">{option.subtitle}</div>
                                </button>
                            ))}
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-white">
                    <div className="bg-red-600 text-white">
                        <div className="max-w-4xl mx-auto px-6 py-4">
                            <h1 className="text-2xl font-bold">Government of Jersey</h1>
                        </div>
                    </div>

                    <div className="bg-gray-100 border-b border-gray-300">
                        <div className="max-w-4xl mx-auto px-6 py-3">
                            <p className="text-sm text-gray-700">
                                <a href="#" className="text-red-600 hover:underline">Home</a>
                                <span className="mx-2">&gt;</span>
                                <a href="#" className="text-red-600 hover:underline">Taxes and money</a>
                                <span className="mx-2">&gt;</span>
                                <span>Tax residency assessment</span>
                            </p>
                        </div>
                    </div>

                    <div className="max-w-4xl mx-auto px-6 py-8">
                        <div className="mb-8">
                            <h2 className="text-3xl font-bold text-gray-900 mb-4">Jersey Tax Residency Assessment</h2>
                            <p className="text-lg text-gray-700 leading-relaxed">
                                Determine your tax residency status for Jersey income tax purposes. Your residency status determines what income you pay tax on and what allowances you receive.
                            </p>
                        </div>

                        <div className="bg-white border border-gray-300 rounded p-6 mb-6 shadow-sm">
                            {renderStep()}
                        </div>

                        <div className="bg-blue-50 border border-blue-200 rounded p-6">
                            <h3 className="text-lg font-bold text-gray-900 mb-3">Important Information</h3>
                            <ul className="space-y-3 text-sm text-gray-800">
                                <li className="flex items-start">
                                    <span className="text-red-600 mr-2 font-bold">•</span>
                                    <span className="leading-relaxed">This tool provides guidance only. For specific advice, contact Revenue Jersey or a tax professional.</span>
                                </li>
                                <li className="flex items-start">
                                    <span className="text-red-600 mr-2 font-bold">•</span>
                                    <span className="leading-relaxed">Double tax agreements with other jurisdictions may affect your tax position.</span>
                                </li>
                                <li className="flex items-start">
                                    <span className="text-red-600 mr-2 font-bold">•</span>
                                    <span className="leading-relaxed">Visit <a href="https://www.gov.je/TaxesMoney/IncomeTax/Individuals/IncomeTaxCircumstances/pages/residencyforjerseytax.aspx" className="text-red-600 underline hover:text-red-700">gov.je</a> for complete residency information.</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <div className="bg-gray-800 text-white mt-12">
                        <div className="max-w-4xl mx-auto px-6 py-8">
                            <div className="text-center">
                                <p className="text-sm">&copy; {new Date().getFullYear()} Government of Jersey. All rights reserved.</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<JerseyTaxResidency />, document.getElementById('root'));
    </script>
</body>
</html>
